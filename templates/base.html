<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="{{ LANGUAGE_CODE }}" lang="{{ LANGUAGE_CODE }}">
{% load i18n %}
{% load tagging_tags %}
{% load urlsearch %}
{% load cache %}
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="{{ LANGUAGE_CODE }}" />
    <meta name="language" content="{{ LANGUAGE_CODE }}" />
    {% if not event %}
        <meta name="description" content="{% trans "an open community driven calendar, tagged and localized events" %}" />
        <meta name="keywords" content="{% trans 'events' %}, {% trans 'calendar' %}, {% trans 'community' %}, {% trans 'open' %}, {% trans 'social' %} {% trans 'free' %}" />
    {% else %}
        <meta name="description" content="{{ event.title }}" />
        <meta name="keywords" content="{{ event.tags_separated_by_comma }}" />
    {% endif %}
    <title>{{ title }}</title>
    <link href="{{ MEDIA_URL }}css/main.css" rel="stylesheet" type="text/css" />
    <!--
    <link href="{{ MEDIA_URL }}css/print.css" rel="stylesheet" type="text/css" media="print" />
    -->
    <link rel="shortcut icon" href="{{ MEDIA_URL }}favicon.ico" />

    <!-- see http://en.wikipedia.org/wiki/Favicon -->
    <link rel="apple-touch-icon" href="{{ MEDIA_URL }}icon-apple-57x57.png" />
    {% block extraheaders %}{% endblock %}
    <!--
    <script type="text/javascript" src="{{ MEDIA_URL }}javascript/external.js"></script>
    -->
</head>

<body>

<div id="header">
    <a href="/"><img id="logo" src="{{ MEDIA_URL }}grical-logo-v4-317x90.png" alt="{{ DOMAIN }} {% trans 'logo' %}" /></a>
    {% if user.username %}
        {% blocktrans with user.username as username %}
            Logged&nbsp;in&nbsp;as&nbsp;{{ username }}
        {% endblocktrans %}
        |&nbsp;<a href="{% url settings %}">{% trans "settings" %}</a>
        |&nbsp;<a href="{% url auth_logout %}">{% trans "logout" %}</a>
    {% else %}
        <a href="{% url registration_register %}">{% trans "Sign&nbsp;up" %}</a>
        |&nbsp;<a href="{% url auth_login %}?next={% firstof request.path '/' %}">{% trans "log&nbsp;in" %}</a>
    {% endif %}
    |&nbsp;<a href="{% url help %}">{% trans "help" %}</a>
    |&nbsp;<a href="{% url legal_notice %}">{% trans "legal&nbsp;notice" %}</a>
    <br />
    <form id="search" action="{% url search %}">
        <div id="search_form">
            <input maxlength="2048" size="40" name="query" value="{{ query }}" />&nbsp;<input type="submit" value="{% trans "Search" %}" />
            {% if current_view %}
                <input style="display:none" type="hidden" size="60" name="view" value="{{ current_view }}" />
            {% endif %}
        </div>
    </form>

    {% block views %} {% endblock %}

    {# TODO: create a selectable list or link for changing the language, see http://docs.djangoproject.com/en/1.2/topics/i18n/internationalization/#the-set-language-redirect-view #}
</div>

<div class="container">
    {% block search_info %} {% endblock %}
    {% block messages %}
        {% if messages %}{# see http://docs.djangoproject.com/en/1.3/ref/contrib/messages/ #}
        <ul class="messages">
            {% for message in messages %}
            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    {% endblock %}
    {% block container %} {% endblock %}
</div>

<div id="footer">
    <div class="title">{% trans "Social" %}</div>
    <div class="info">
      <ul>
        <li>
            <!-- AddToAny BEGIN -->
            {# TODO: Cache it. Provider allows to Cache it for 24 hours automatically. See provider's FAQ #}
            <a class="a2a_dd" href="{{ PROTOCOL }}://www.addtoany.com/share_save"><img src="{{ PROTOCOL }}://static.addtoany.com/buttons/share_save_171_16.png" width="171" height="16" alt="Share" /></a>
            <script type="text/javascript">
            var a2a_config = a2a_config || {};
            a2a_config.linkname = "GriCal";
            a2a_config.onclick = 1;
            a2a_config.color_main = "9DBCD3";
            a2a_config.color_border = "2C516D";
            a2a_config.color_link_text = "AFC4D3";
            a2a_config.color_link_text_hover = "333333";
            a2a_config.color_bg = "000000";
            a2a_config.color_arrow = "fff";
            </script>
            <script type="text/javascript" src="{{ PROTOCOL }}://static.addtoany.com/menu/page.js"></script>
            <!-- AddToAny END -->
        </li>
      </ul>
    </div>
    <div class="title">{% trans "Openness" %}</div>
    <div class="info">
      <ul>
        <li>
            <a href="http://www.opendefinition.org/software-service/">
                <img src="{{ MEDIA_URL }}os_80x15_blue.png" alt="{% trans 'OPEN SERVICE' %}" />
            </a>
        </li>
        <li>
            <a href="http://www.opendefinition.org/okd/">
                <img src="{{ MEDIA_URL }}open-data-80x15-blue.png" alt="{% trans 'OPEN DATA' %}" />
            </a>
        </li>
        <li>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/de/deed.en">
                <img src="{{ MEDIA_URL }}cc-by-sa-germany.png" alt="{% trans 'CC-BY-SA' %}" />
            </a>
        </li>
        <li>
            <a href="http://www.gnu.org/licenses/agpl.html">
                <img src="{{ MEDIA_URL }}agpl3.png" alt="{% trans 'AGPL3 LICENSED' %}" />
            </a>
        </li>
      </ul>
    </div>
    <div class="title">{% trans "Support" %}</div>
    <div class="info">
      <ul>
        <li>
            <a href="http://flattr.com/thing/85499/GridCalendar-Community-Calendar">
                <img src="{{ MEDIA_URL }}flattr-badge-large.png" alt="Flattr this" /></a>
        </li>
        <li><a href="{% url contact_form %}">{% trans "feedback" %}</a></li>
      </ul>
    </div>
    <div class="title">{% trans "Community" %}</div>
    <div class="info">
        <ul>
            <li> <a href="http://code.grical.org/browser">{% trans "source code" %}</a> </li>
            <li> <a href="http://code.grical.org/wiki">{% trans "wiki" %}</a> </li>
            <li> <a href="http://lists.gridmind.org/listinfo/grical">{% trans "mailing list" %}</a> </li>
            <li> <a href="irc://irc.freenode.net/calendar">{% trans "IRC: Freenode #calendar" %}</a> </li>
        </ul>
    </div>
    <div class="title">{% trans "Software" %}</div>
    <div class="info">
        <ul>
            <li>
                <a href="http://code.grical.org">
                    {% blocktrans with VERSION as VERSION %}
                        running the free software GridCalendar {{ VERSION }}
                    {% endblocktrans %}
                </a>
            </li>
        </ul>
    </div>
    <div class="title">{% trans "Statistics" %}</div>
    <div class="info">
        <ul>
            <li> {% trans "events:" %} {{ EVENTS_NR }} </li>
            <li> {% trans "users:" %} {{ USERS_NR }} </li>
            <li> {% trans "groups:" %}{{ GROUPS_NR }} </li>
        </ul>
    </div>
    <div class="title">{% trans "RSS feeds" %}</div>
    <div class="info">
        <ul>
            <li> <a href="{% url upcoming_events_rss %}">{% trans "upcoming RSS feed" %}</a></li>
            <li> <a href="{% url lastadded_events_rss %}">{% trans "last added RSS feed" %}</a></li>
        </ul>
    </div>
    {% cache 3600 tags_cloud %}
        <div class="title">{% trans "Tags cloud" %}</div>
        <div class="info">
            {% comment %}TODO: generate this is views.py {% endcomment %}
            {% tag_cloud_for_model events.Event as tags with steps=10 min_count=10 distribution=log %}
            {% for tag in tags %}
                <span class="tag_{{ tag.font_size }}"><a href="{% urlsearch tag=tag.name|slugify %}">
                    {{ tag.name }}</a></span>
            {% endfor %}
        </div>
    {% endcache %}
</div>

</body>
</html>
